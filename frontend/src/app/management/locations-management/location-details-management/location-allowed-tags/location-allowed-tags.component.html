<div class="container-fluid" *ngIf="location | async as location">
  <div class="panel-body" style="padding: 20px">
    <div>
      <div class="row alert alert-info">
        <p>{{'management.locationDetails.allowedTags.activeTagsInformation' | translate}}</p>
        <p>{{'management.locationDetails.allowedTags.updateTagsInformation' | translate}}</p>

        <div class="pull-right">
          <button class="btn btn-secondary" data-toggle="modal" data-target="#updateAllowedTagsConfigurationModal"
                  (click)="prepareUpdateTheTags()">
            {{'management.locationDetails.allowedTags.updateTagsButton' | translate}}
          </button>
        </div>
      </div>

      <div *ngIf="tagsThatAreAllowed && tagsThatAreAllowed.length > 0; else noAllowedTags">
        <ul>
          <li *ngFor="let tag of tagsThatAreAllowed">
            {{currentLang === 'nl' ? tag.dutch : tag.english}}
          </li>
        </ul>
      </div>
    </div>
  </div>
</div>

<ng-template #noAllowedTags>
  <div class="alert alert-warning">
    {{'management.locationDetails.allowedTags.noTagsSelected' | translate}}
  </div>
</ng-template>

<!-- Modal view to update the tags configuration of the location -->
<div class="modal fade" id="updateAllowedTagsConfigurationModal" tabindex="-1" role="dialog"
     aria-labelledby="updateAllowedTagsConfigurationModalTitle" aria-hidden="true">
  <div class="modal-dialog" role="document">
    <div class="modal-content">

      <!-- Modal header -->
      <div class="modal-header">
        <h5 class="modal-title" id="updateAllowedTagsConfigurationModalTitle">
          {{'management.locationDetails.allowedTags.updateAllowedTagsConfigurationModal.title' | translate}}
        </h5>
      </div>

      <!-- Modal body -->
      <div class="modal-body">
        <div class="container-fluid">
          <div class="row">
            <p>{{('management.locationDetails.allowedTags.updateAllowedTagsConfigurationModal.body' | translate)
              .replace('{locationName}', locationName)}}</p>
          </div>

          <div class="row" style="margin-top: 20px;">
            <mat-form-field>
              <mat-label>
                {{'management.locationDetails.allowedTags.updateAllowedTagsConfigurationModal.comboboxTitle' | translate}}
              </mat-label>
              <mat-select multiple (selectionChange)="selectionChanged($event)"
                          [formControl]="tagsFormControl" [compareWith]="compareTagsInSelection">
                <mat-option *ngFor="let tag of allPossibleTags" [value]="tag">
                  {{currentLang === 'nl' ? tag.dutch : tag.english}}
                </mat-option>
              </mat-select>
            </mat-form-field>
          </div>
        </div>
      </div>

      <!-- Modal footer -->
      <div class="modal-footer">
        <button type="submit" class="btn btn-primary"
                [disabled]="!tagsSelectionIsUpdatable"
                (click)="updateTags()">
          {{'general.buttons.update' | translate}}
        </button>
        <button type="button" class="btn btn-secondary"
                data-dismiss="modal">
          {{'general.buttons.cancel' | translate}}
        </button>
      </div>

      <!-- Feedback to the user -->
      <div class="container-fluid">
        <div class="alert alert-info" *ngIf="successUpdatingTagsConfiguration === null">
          {{'general.waitingForServer' | translate}}
        </div>

        <div class="alert alert-success" *ngIf="successUpdatingTagsConfiguration === true">
          {{('management.locationDetails.allowedTags.updateAllowedTagsConfigurationModal.success' | translate).replace('{locationName}', locationName)}}
        </div>

        <div class="alert alert-error" *ngIf="successUpdatingTagsConfiguration === false">
          {{('management.locationDetails.allowedTags.updateAllowedTagsConfigurationModal.error' | translate).replace('{locationName}', locationName)}}
        </div>
      </div>

    </div>
  </div>
</div>
